Narou.rb ― 「小説家になろう」「小説を読もう！」ダウンローダ＆縦書用整形スクリプト
============================================================

[![Gem Version](https://badge.fury.io/rb/narou.svg)](http://badge.fury.io/rb/narou)

概要 - Summary
--------------
このアプリは[小説家になろう](http://syosetu.com/)、[小説を読もう！](http://yomou.syosetu.com/)で公開されている小説の管理、
及び電子書籍データへの変換を支援します。縦書き用に特化されており、
横書き用に特化されたWEB小説を違和感なく縦書きで読むことが出来るようになります。
また、校正機能もありますので、小説としての一般的な整形ルールに矯正します。（例：感嘆符のあとにはスペースが必ずくる）

対応小説サイト：
+ 小説家になろう http://syosetu.com/
+ ノクターンノベルズ http://noc.syosetu.com/
+ ムーンライトノベルズ http://mnlt.syosetu.com/
+ ミッドナイトノベルズ http://mid.syosetu.com/
+ ハーメルン https://syosetu.org/
+ Arcadia http://www.mai-net.net/
+ 暁 http://www.akatsuki-novels.com/ （※300話以上ある作品は未対応）
+ カクヨム https://kakuyomu.jp/

コンソールで操作するアプリケーションですが、ブラウザを使って直感的に操作することができる WEB UI も搭載！（[デモページ](http://whiteleaf7.github.io/narou/demo/)）

主な機能は小説家になろうの小説のダウンロード、更新管理、テキスト整形、AozoraEpub3・kindlegen連携によるEPUB/MOBI出力です。

詳細な説明やインストール方法は **[Narou.rb 説明書](https://github.com/whiteleaf7/narou/wiki)** を御覧ください。

![WEB UI ScreenCapture](https://raw.github.com/wiki/whiteleaf7/narou/images/webui_cap.png)
![Console ScreenCapture](https://raw.github.com/wiki/whiteleaf7/narou/images/narou_cap.gif)

更新履歴 - ChangeLog
--------------------

2.9.1 : 2016/03/30
------------------
#### 仕様変更
- 「メニュー＞表示」の、「ボタンを画面下部に固定」を「ボタンを画面下部に表示」
  に変更しました。それに合わせて、「ボタンをページ上部に表示」を追加しました。
  画面下部にボタンを固定表示した場合でも、今までのボタンを残せるようになります

#### 修正
- inspect コマンドでエラーが出る場合があったのを修正
- diff コマンドの引数を省略した時にエラーが出ていたのを修正
- Internet Explorer で WEB UI が正常に動作しない不具合を修正


2.9.0 : 2016/03/28
------------------
#### WEB UI
- メニュー(歯車アイコン)に「サーバを再起動」を追加しました。WEB UIから直接WEB
  UIサーバを再起動できるようになります
- 「Narou.rbについて」ダイアログで最新バージョンを確認できた場合に、その場で
  システムの更新及び再起動が出来るようになりました。
  （sudo が必要な環境の場合はコマンドで更新して下さい）
- 小説リスト部分で右クリックすることで個別メニューを呼び出せるようになりました
- 各小説をそれぞれ個別に更新出来るボタンを追加しました
- 「表示」メニューを拡張しました
	+ 「変換設定ページは新規タブで開く」を追加しました
	+ 「ボタンを画面下部に固定」を追加しました
	+ 「個別メニューを編集」を追加しました
- 「ツール」に「メモ帳」を追加しました
	+ メモはサーバに保存され、各PC間で共有出来ます。個別メニューの編集内容の
	  受渡しや小説URLの一時的プールなどに使うことを想定しています
- タグ検索をフィルターに統合しました
	+ フィルター欄に `tag:タグ名` と入力することでタグ検索が可能になります。
	  （既存のキーワード検索との併用も可能です）
	+ `tag:タグ名1 tag:タグ名2` と複数入力することで、複数のタグでの絞り込みが
	  可能です
	+ `-tag:タグ名` と `-` を付けることで、除外タグ検索になります
	+ メニューのタグか小説リストのタグ名をクリックすることで、フィルター欄に自動
	  で入力されます。また、Altキーを押しながらクリックすることで、除外タグが入力
	  されます
- タグの並び順をソートするようにしました
- 一部のボタンのアイコンを変更しました
- ツールチップを表示してしばらくしたら自動で閉じるようにしました
- 表示件数に200、500を追加しました
- 電子書籍端末を接続時に、取り外すための Eject ボタンを表示するようにしました
  （現時点でMacのみサポート）

#### 追加機能
- [カクヨム](https://kakuyomu.jp/)に対応しました
	+ 各話の更新状況を（目次ページから）取得する方法が現時点で無いので、新着のみ
	  取得出来ます（各話を最新の状態にしたい場合は、強制ダウンロードをする必要が
	  あります）
- `narou setting 変数名` コマンドで現在の設定値を確認出来るようになりました。
  (例 `narou s device`)
- `list` コマンドに `--gl` オプションが追加されました
	+ 表示・ソート対象の日付を更新日から最新話掲載日に切り替えます
	+ general-lastup の略です
- 変換プリセットを追加しました
	- n5115cq 最果てのパラディン
	- n7594ct 10年ごしの引きニートを辞めて外出したら自宅ごと異世界に転移してた

#### 仕様変更
- 変換処理で body や introduction 等を処理して最後に subtitle を変換していた
  のを先に subtitle を処理するように変更しました
	- converter.rb でサブタイトルで本文の処理内容を調整したい場合に今までの処理順
	  では不可能だったため
- title_date_format の $s が古い作品だと5桁になってしまうのを4桁に収まるように
  調整しました（小説家になろうの最も古い作品が4桁に収まるようにしました）
- `あ゛` のような記述を濁点フォントに置き換える処理を廃止し、AozoraEpub3 による
  一文字フォント置き換え機能に任せるようにしました
	+ `narou init` が必要です
	+ この変更に伴い、setting.ini の enable_dakuten_font は廃止されました
	+ Kindle 端末において、挿絵が表紙画像になってしまう問題がこの仕様変更で改善
	  されます

#### 修正
- httpsなサイトでダウンロード用のブックマークレットが動かない問題に対応しました
  （ヘルプからブックマークレットの再取得が必要です）
- Windows において、WEB UI の「Narou.rbについて」ダイアログで最新バージョンの
  確認に失敗する場合がある問題に対応しました
- WEB UI の小説リストの項目を入れ替えた後に各種ボタンが反応しなくなるのを修正
- 凍結済み小説を強制更新した際に凍結が解除されてしまう場合があったのを修正
- thin などがすでにインストール済みの場合に narou web コマンドで WEB UI サーバ
  を起動できない場合があるので、必ず WEBrick で起動するようにしました
- ノクターン・ムーンライト・ミッドナイトノベルズの認証方法変更後、Nコードのみで
  ダウンロードが出来なくなっていたのを修正
- Linux でダウンロード時にエラーが出る場合があったのを修正
- その他パフォーマンス等の調整


----

過去の更新履歴は[こちらを参照](https://github.com/whiteleaf7/narou/blob/master/ChangeLog.md)

----

「小説家になろう」は株式会社ヒナプロジェクトの登録商標です
